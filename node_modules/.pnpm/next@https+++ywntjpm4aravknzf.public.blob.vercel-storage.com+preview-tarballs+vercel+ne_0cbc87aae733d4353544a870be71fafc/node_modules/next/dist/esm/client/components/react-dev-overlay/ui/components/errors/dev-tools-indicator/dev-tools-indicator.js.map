{"version":3,"sources":["../../../../../../../../src/client/components/react-dev-overlay/ui/components/errors/dev-tools-indicator/dev-tools-indicator.tsx"],"sourcesContent":["import type { CSSProperties, Dispatch, SetStateAction } from 'react'\nimport { STORAGE_KEY_POSITION, type OverlayState } from '../../../../shared'\n\nimport { useState, useEffect, useRef, createContext, useContext } from 'react'\nimport { Toast } from '../../toast'\nimport { NextLogo } from './next-logo'\nimport { useIsDevBuilding } from '../../../../../../dev/dev-build-indicator/internal/initialize'\nimport { useIsDevRendering } from '../../../../utils/dev-indicator/dev-render-indicator'\nimport { useDelayedRender } from '../../../hooks/use-delayed-render'\nimport { TurbopackInfo } from './dev-tools-info/turbopack-info'\nimport { RouteInfo } from './dev-tools-info/route-info'\nimport GearIcon from '../../../icons/gear-icon'\nimport { UserPreferences } from './dev-tools-info/user-preferences'\nimport { SegmentsExplorer } from '../../overview/segment-explorer'\nimport {\n  MENU_CURVE,\n  MENU_DURATION_MS,\n  useClickOutside,\n  useFocusTrap,\n} from './utils'\nimport {\n  getInitialPosition,\n  type DevToolsScale,\n} from './dev-tools-info/preferences'\nimport { Draggable } from './draggable'\n\n// TODO: add E2E tests to cover different scenarios\n\nexport function DevToolsIndicator({\n  state,\n  errorCount,\n  isBuildError,\n  setIsErrorOverlayOpen,\n  ...props\n}: {\n  state: OverlayState\n  errorCount: number\n  isBuildError: boolean\n  setIsErrorOverlayOpen: (\n    isErrorOverlayOpen: boolean | ((prev: boolean) => boolean)\n  ) => void\n  scale: DevToolsScale\n  setScale: (value: DevToolsScale) => void\n}) {\n  const [isDevToolsIndicatorVisible, setIsDevToolsIndicatorVisible] =\n    useState(true)\n\n  return (\n    <DevToolsPopover\n      routerType={state.routerType}\n      semver={state.versionInfo.installed}\n      issueCount={errorCount}\n      isStaticRoute={state.staticIndicator}\n      hide={() => {\n        setIsDevToolsIndicatorVisible(false)\n        fetch('/__nextjs_disable_dev_indicator', {\n          method: 'POST',\n        })\n      }}\n      setIsErrorOverlayOpen={setIsErrorOverlayOpen}\n      isTurbopack={!!process.env.TURBOPACK}\n      disabled={state.disableDevIndicator || !isDevToolsIndicatorVisible}\n      isBuildError={isBuildError}\n      {...props}\n    />\n  )\n}\n\n//////////////////////////////////////////////////////////////////////////////////////\n\ninterface C {\n  closeMenu: () => void\n  selectedIndex: number\n  setSelectedIndex: Dispatch<SetStateAction<number>>\n}\n\nconst Context = createContext({} as C)\n\nconst OVERLAYS = {\n  Root: 'root',\n  Turbo: 'turbo',\n  Route: 'route',\n  Preferences: 'preferences',\n  SegmentExplorer: 'segment-explorer',\n} as const\n\nexport type Overlays = (typeof OVERLAYS)[keyof typeof OVERLAYS]\n\nconst INDICATOR_PADDING = 20\n\nfunction DevToolsPopover({\n  routerType,\n  disabled,\n  issueCount,\n  isStaticRoute,\n  isTurbopack,\n  isBuildError,\n  hide,\n  setIsErrorOverlayOpen,\n  scale,\n  setScale,\n}: {\n  routerType: 'pages' | 'app'\n  disabled: boolean\n  issueCount: number\n  isStaticRoute: boolean\n  semver: string | undefined\n  isTurbopack: boolean\n  isBuildError: boolean\n  hide: () => void\n  setIsErrorOverlayOpen: (\n    isOverlayOpen: boolean | ((prev: boolean) => boolean)\n  ) => void\n  scale: DevToolsScale\n  setScale: (value: DevToolsScale) => void\n}) {\n  const menuRef = useRef<HTMLDivElement>(null)\n  const triggerRef = useRef<HTMLButtonElement | null>(null)\n\n  const [open, setOpen] = useState<Overlays | null>(null)\n  const [position, setPosition] = useState(getInitialPosition())\n  const [selectedIndex, setSelectedIndex] = useState(-1)\n\n  const isMenuOpen = open === OVERLAYS.Root\n  const isTurbopackInfoOpen = open === OVERLAYS.Turbo\n  const isRouteInfoOpen = open === OVERLAYS.Route\n  const isPreferencesOpen = open === OVERLAYS.Preferences\n  const isSegmentExplorerOpen = open === OVERLAYS.SegmentExplorer\n\n  const { mounted: menuMounted, rendered: menuRendered } = useDelayedRender(\n    isMenuOpen,\n    {\n      // Intentionally no fade in, makes the UI feel more immediate\n      enterDelay: 0,\n      // Graceful fade out to confirm that the UI did not break\n      exitDelay: MENU_DURATION_MS,\n    }\n  )\n\n  // Features to make the menu accessible\n  useFocusTrap(menuRef, triggerRef, isMenuOpen)\n  useClickOutside(menuRef, triggerRef, isMenuOpen, closeMenu)\n\n  useEffect(() => {\n    if (open === null) {\n      // Avoid flashing selected state\n      const id = setTimeout(() => {\n        setSelectedIndex(-1)\n      }, MENU_DURATION_MS)\n      return () => clearTimeout(id)\n    }\n  }, [open])\n\n  function select(index: number | 'first' | 'last') {\n    if (index === 'first') {\n      setTimeout(() => {\n        const all = menuRef.current?.querySelectorAll('[role=\"menuitem\"]')\n        if (all) {\n          const firstIndex = all[0].getAttribute('data-index')\n          select(Number(firstIndex))\n        }\n      })\n      return\n    }\n\n    if (index === 'last') {\n      setTimeout(() => {\n        const all = menuRef.current?.querySelectorAll('[role=\"menuitem\"]')\n        if (all) {\n          const lastIndex = all.length - 1\n          select(lastIndex)\n        }\n      })\n      return\n    }\n\n    const el = menuRef.current?.querySelector(\n      `[data-index=\"${index}\"]`\n    ) as HTMLElement\n\n    if (el) {\n      setSelectedIndex(index)\n      el?.focus()\n    }\n  }\n\n  function onMenuKeydown(e: React.KeyboardEvent<HTMLDivElement>) {\n    e.preventDefault()\n\n    switch (e.key) {\n      case 'ArrowDown':\n        const next = selectedIndex + 1\n        select(next)\n        break\n      case 'ArrowUp':\n        const prev = selectedIndex - 1\n        select(prev)\n        break\n      case 'Home':\n        select('first')\n        break\n      case 'End':\n        select('last')\n        break\n      default:\n        break\n    }\n  }\n\n  function openErrorOverlay() {\n    setOpen(null)\n    if (issueCount > 0) {\n      setIsErrorOverlayOpen(true)\n    }\n  }\n\n  function toggleErrorOverlay() {\n    setIsErrorOverlayOpen((prev) => !prev)\n  }\n\n  function openRootMenu() {\n    setOpen((prevOpen) => {\n      if (prevOpen === null) select('first')\n      return OVERLAYS.Root\n    })\n  }\n\n  function onTriggerClick() {\n    if (open === OVERLAYS.Root) {\n      setOpen(null)\n    } else {\n      openRootMenu()\n      setTimeout(() => {\n        select('first')\n      })\n    }\n  }\n\n  function closeMenu() {\n    // Only close when we were on `Root`,\n    // otherwise it will close other overlays\n    setOpen((prevOpen) => {\n      if (prevOpen === OVERLAYS.Root) {\n        return null\n      }\n      return prevOpen\n    })\n  }\n\n  function handleHideDevtools() {\n    setOpen(null)\n    hide()\n  }\n\n  const [vertical, horizontal] = position.split('-', 2)\n  const popover = { [vertical]: 'calc(100% + 8px)', [horizontal]: 0 }\n\n  return (\n    <Toast\n      data-nextjs-toast\n      style={\n        {\n          '--animate-out-duration-ms': `${MENU_DURATION_MS}ms`,\n          '--animate-out-timing-function': MENU_CURVE,\n          boxShadow: 'none',\n          zIndex: 2147483647,\n          [vertical]: `${INDICATOR_PADDING}px`,\n          [horizontal]: `${INDICATOR_PADDING}px`,\n        } as CSSProperties\n      }\n    >\n      <Draggable\n        padding={INDICATOR_PADDING}\n        onDragStart={() => setOpen(null)}\n        position={position}\n        setPosition={(p) => {\n          localStorage.setItem(STORAGE_KEY_POSITION, p)\n          setPosition(p)\n        }}\n      >\n        {/* Trigger */}\n        <NextLogo\n          ref={triggerRef}\n          aria-haspopup=\"menu\"\n          aria-expanded={isMenuOpen}\n          aria-controls=\"nextjs-dev-tools-menu\"\n          aria-label={`${isMenuOpen ? 'Close' : 'Open'} Next.js Dev Tools`}\n          data-nextjs-dev-tools-button\n          disabled={disabled}\n          issueCount={issueCount}\n          onTriggerClick={onTriggerClick}\n          toggleErrorOverlay={toggleErrorOverlay}\n          isDevBuilding={useIsDevBuilding()}\n          isDevRendering={useIsDevRendering()}\n          isBuildError={isBuildError}\n          scale={scale}\n        />\n      </Draggable>\n\n      {/* Route Info */}\n      <RouteInfo\n        isOpen={isRouteInfoOpen}\n        close={openRootMenu}\n        triggerRef={triggerRef}\n        style={popover}\n        routerType={routerType}\n        routeType={isStaticRoute ? 'Static' : 'Dynamic'}\n      />\n\n      {/* Turbopack Info */}\n      <TurbopackInfo\n        isOpen={isTurbopackInfoOpen}\n        close={openRootMenu}\n        triggerRef={triggerRef}\n        style={popover}\n      />\n\n      {/* Preferences */}\n      <UserPreferences\n        isOpen={isPreferencesOpen}\n        close={openRootMenu}\n        triggerRef={triggerRef}\n        style={popover}\n        hide={handleHideDevtools}\n        setPosition={setPosition}\n        position={position}\n        scale={scale}\n        setScale={setScale}\n      />\n\n      {/* Page Segment Explorer */}\n      {process.env.__NEXT_DEVTOOL_SEGMENT_EXPLORER ? (\n        <SegmentsExplorer\n          isOpen={isSegmentExplorerOpen}\n          close={openRootMenu}\n          triggerRef={triggerRef}\n          style={popover}\n        />\n      ) : null}\n\n      {/* Dropdown Menu */}\n      {menuMounted && (\n        <div\n          ref={menuRef}\n          id=\"nextjs-dev-tools-menu\"\n          role=\"menu\"\n          dir=\"ltr\"\n          aria-orientation=\"vertical\"\n          aria-label=\"Next.js Dev Tools Items\"\n          tabIndex={-1}\n          className=\"dev-tools-indicator-menu\"\n          onKeyDown={onMenuKeydown}\n          data-rendered={menuRendered}\n          style={popover}\n        >\n          <Context.Provider\n            value={{\n              closeMenu,\n              selectedIndex,\n              setSelectedIndex,\n            }}\n          >\n            <div className=\"dev-tools-indicator-inner\">\n              {issueCount > 0 && (\n                <MenuItem\n                  title={`${issueCount} ${issueCount === 1 ? 'issue' : 'issues'} found. Click to view details in the dev overlay.`}\n                  index={0}\n                  label=\"Issues\"\n                  value={<IssueCount>{issueCount}</IssueCount>}\n                  onClick={openErrorOverlay}\n                />\n              )}\n              <MenuItem\n                title={`Current route is ${isStaticRoute ? 'static' : 'dynamic'}.`}\n                label=\"Route\"\n                index={1}\n                value={isStaticRoute ? 'Static' : 'Dynamic'}\n                onClick={() => setOpen(OVERLAYS.Route)}\n                data-nextjs-route-type={isStaticRoute ? 'static' : 'dynamic'}\n              />\n              {isTurbopack ? (\n                <MenuItem\n                  title=\"Turbopack is enabled.\"\n                  label=\"Turbopack\"\n                  value=\"Enabled\"\n                />\n              ) : (\n                <MenuItem\n                  index={2}\n                  title=\"Learn about Turbopack and how to enable it in your application.\"\n                  label=\"Try Turbopack\"\n                  value={<ChevronRight />}\n                  onClick={() => setOpen(OVERLAYS.Turbo)}\n                />\n              )}\n            </div>\n\n            <div className=\"dev-tools-indicator-footer\">\n              <MenuItem\n                data-preferences\n                label=\"Preferences\"\n                value={<GearIcon />}\n                onClick={() => setOpen(OVERLAYS.Preferences)}\n                index={isTurbopack ? 2 : 3}\n              />\n              {process.env.__NEXT_DEVTOOL_SEGMENT_EXPLORER ? (\n                <MenuItem\n                  data-rendered-files\n                  label=\"Segment Explorer\"\n                  value={<ChevronRight />}\n                  onClick={() => setOpen(OVERLAYS.SegmentExplorer)}\n                  index={isTurbopack ? 3 : 4}\n                />\n              ) : null}\n            </div>\n          </Context.Provider>\n        </div>\n      )}\n    </Toast>\n  )\n}\n\nfunction ChevronRight() {\n  return (\n    <svg\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 16 16\"\n      fill=\"none\"\n    >\n      <path\n        fill=\"#666\"\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M5.50011 1.93945L6.03044 2.46978L10.8537 7.293C11.2442 7.68353 11.2442 8.31669 10.8537 8.70722L6.03044 13.5304L5.50011 14.0608L4.43945 13.0001L4.96978 12.4698L9.43945 8.00011L4.96978 3.53044L4.43945 3.00011L5.50011 1.93945Z\"\n      />\n    </svg>\n  )\n}\n\nfunction MenuItem({\n  index,\n  label,\n  value,\n  onClick,\n  href,\n  ...props\n}: {\n  index?: number\n  title?: string\n  label: string\n  value: React.ReactNode\n  href?: string\n  onClick?: () => void\n}) {\n  const isInteractive =\n    typeof onClick === 'function' || typeof href === 'string'\n  const { closeMenu, selectedIndex, setSelectedIndex } = useContext(Context)\n  const selected = selectedIndex === index\n\n  function click() {\n    if (isInteractive) {\n      onClick?.()\n      closeMenu()\n      if (href) {\n        window.open(href, '_blank', 'noopener, noreferrer')\n      }\n    }\n  }\n\n  return (\n    <div\n      className=\"dev-tools-indicator-item\"\n      data-index={index}\n      data-selected={selected}\n      onClick={click}\n      // Needs `onMouseMove` instead of enter to work together\n      // with keyboard and mouse input\n      onMouseMove={() => {\n        if (isInteractive && index !== undefined && selectedIndex !== index) {\n          setSelectedIndex(index)\n        }\n      }}\n      onMouseLeave={() => setSelectedIndex(-1)}\n      onKeyDown={(e) => {\n        if (e.key === 'Enter' || e.key === ' ') {\n          click()\n        }\n      }}\n      role={isInteractive ? 'menuitem' : undefined}\n      tabIndex={selected ? 0 : -1}\n      {...props}\n    >\n      <span className=\"dev-tools-indicator-label\">{label}</span>\n      <span className=\"dev-tools-indicator-value\">{value}</span>\n    </div>\n  )\n}\n\nfunction IssueCount({ children }: { children: number }) {\n  return (\n    <span\n      className=\"dev-tools-indicator-issue-count\"\n      data-has-issues={children > 0}\n    >\n      <span className=\"dev-tools-indicator-issue-count-indicator\" />\n      {children}\n    </span>\n  )\n}\n\n//////////////////////////////////////////////////////////////////////////////////////\n\nexport const DEV_TOOLS_INDICATOR_STYLES = `\n  .dev-tools-indicator-menu {\n    -webkit-font-smoothing: antialiased;\n    display: flex;\n    flex-direction: column;\n    align-items: flex-start;\n    background: var(--color-background-100);\n    border: 1px solid var(--color-gray-alpha-400);\n    background-clip: padding-box;\n    box-shadow: var(--shadow-menu);\n    border-radius: var(--rounded-xl);\n    position: absolute;\n    font-family: var(--font-stack-sans);\n    z-index: 1000;\n    overflow: hidden;\n    opacity: 0;\n    outline: 0;\n    min-width: 248px;\n    transition: opacity var(--animate-out-duration-ms)\n      var(--animate-out-timing-function);\n\n    &[data-rendered='true'] {\n      opacity: 1;\n      scale: 1;\n    }\n  }\n\n  .dev-tools-indicator-inner {\n    padding: 6px;\n    width: 100%;\n  }\n\n  .dev-tools-indicator-item {\n    display: flex;\n    align-items: center;\n    padding: 8px 6px;\n    height: var(--size-36);\n    border-radius: 6px;\n    text-decoration: none !important;\n    user-select: none;\n    white-space: nowrap;\n\n    svg {\n      width: var(--size-16);\n      height: var(--size-16);\n    }\n\n    &:focus-visible {\n      outline: 0;\n    }\n  }\n\n  .dev-tools-indicator-footer {\n    background: var(--color-background-200);\n    padding: 6px;\n    border-top: 1px solid var(--color-gray-400);\n    width: 100%;\n  }\n\n  .dev-tools-indicator-item[data-selected='true'] {\n    cursor: pointer;\n    background-color: var(--color-gray-200);\n  }\n\n  .dev-tools-indicator-label {\n    font-size: var(--size-14);\n    line-height: var(--size-20);\n    color: var(--color-gray-1000);\n  }\n\n  .dev-tools-indicator-value {\n    font-size: var(--size-14);\n    line-height: var(--size-20);\n    color: var(--color-gray-900);\n    margin-left: auto;\n  }\n\n  .dev-tools-indicator-issue-count {\n    --color-primary: var(--color-gray-800);\n    --color-secondary: var(--color-gray-100);\n    display: flex;\n    flex-direction: row;\n    align-items: center;\n    justify-content: center;\n    gap: 8px;\n    min-width: var(--size-40);\n    height: var(--size-24);\n    background: var(--color-background-100);\n    border: 1px solid var(--color-gray-alpha-400);\n    background-clip: padding-box;\n    box-shadow: var(--shadow-small);\n    padding: 2px;\n    color: var(--color-gray-1000);\n    border-radius: 128px;\n    font-weight: 500;\n    font-size: var(--size-13);\n    font-variant-numeric: tabular-nums;\n\n    &[data-has-issues='true'] {\n      --color-primary: var(--color-red-800);\n      --color-secondary: var(--color-red-100);\n    }\n\n    .dev-tools-indicator-issue-count-indicator {\n      width: var(--size-8);\n      height: var(--size-8);\n      background: var(--color-primary);\n      box-shadow: 0 0 0 2px var(--color-secondary);\n      border-radius: 50%;\n    }\n  }\n\n  .dev-tools-indicator-shortcut {\n    display: flex;\n    gap: 4px;\n\n    kbd {\n      width: var(--size-20);\n      height: var(--size-20);\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      border-radius: var(--rounded-md);\n      border: 1px solid var(--color-gray-400);\n      font-family: var(--font-stack-sans);\n      background: var(--color-background-100);\n      color: var(--color-gray-1000);\n      text-align: center;\n      font-size: var(--size-12);\n      line-height: var(--size-16);\n    }\n  }\n\n  .dev-tools-grabbing {\n    cursor: grabbing;\n\n    > * {\n      pointer-events: none;\n    }\n  }\n`\n"],"names":["STORAGE_KEY_POSITION","useState","useEffect","useRef","createContext","useContext","Toast","NextLogo","useIsDevBuilding","useIsDevRendering","useDelayedRender","TurbopackInfo","RouteInfo","GearIcon","UserPreferences","SegmentsExplorer","MENU_CURVE","MENU_DURATION_MS","useClickOutside","useFocusTrap","getInitialPosition","Draggable","DevToolsIndicator","state","errorCount","isBuildError","setIsErrorOverlayOpen","props","isDevToolsIndicatorVisible","setIsDevToolsIndicatorVisible","DevToolsPopover","routerType","semver","versionInfo","installed","issueCount","isStaticRoute","staticIndicator","hide","fetch","method","isTurbopack","process","env","TURBOPACK","disabled","disableDevIndicator","Context","OVERLAYS","Root","Turbo","Route","Preferences","SegmentExplorer","INDICATOR_PADDING","scale","setScale","menuRef","triggerRef","open","setOpen","position","setPosition","selectedIndex","setSelectedIndex","isMenuOpen","isTurbopackInfoOpen","isRouteInfoOpen","isPreferencesOpen","isSegmentExplorerOpen","mounted","menuMounted","rendered","menuRendered","enterDelay","exitDelay","closeMenu","id","setTimeout","clearTimeout","select","index","all","current","querySelectorAll","firstIndex","getAttribute","Number","lastIndex","length","el","querySelector","focus","onMenuKeydown","e","preventDefault","key","next","prev","openErrorOverlay","toggleErrorOverlay","openRootMenu","prevOpen","onTriggerClick","handleHideDevtools","vertical","horizontal","split","popover","data-nextjs-toast","style","boxShadow","zIndex","padding","onDragStart","p","localStorage","setItem","ref","aria-haspopup","aria-expanded","aria-controls","aria-label","data-nextjs-dev-tools-button","isDevBuilding","isDevRendering","isOpen","close","routeType","__NEXT_DEVTOOL_SEGMENT_EXPLORER","div","role","dir","aria-orientation","tabIndex","className","onKeyDown","data-rendered","Provider","value","MenuItem","title","label","IssueCount","onClick","data-nextjs-route-type","ChevronRight","data-preferences","data-rendered-files","svg","xmlns","width","height","viewBox","fill","path","fillRule","clipRule","d","href","isInteractive","selected","click","window","data-index","data-selected","onMouseMove","undefined","onMouseLeave","span","children","data-has-issues","DEV_TOOLS_INDICATOR_STYLES"],"mappings":"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","ignoreList":[0]}